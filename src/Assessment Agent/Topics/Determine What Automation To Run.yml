kind: AdaptiveDialog
beginDialog:
  kind: OnRedirect
  id: main
  condition: =!IsBlank(Global.AssessmentRecord)
  actions:
    - kind: Question
      id: question_M9PVF1
      interruptionPolicy:
        allowInterruption: true

      variable: init:Topic.PlatformsToScan
      prompt: For the assessment {Global.AssessmentRecord.msft_name} do you want to run an automated assessment as well? If so pick
      entity:
        kind: EmbeddedEntity
        definition:
          kind: ClosedListEntity
          items:
            - id: Environment
              displayName: Environment

            - id: Tenant
              displayName: Tenant

            - id: None
              displayName: None

    - kind: ConditionGroup
      id: conditionGroup_2oz1OM
      conditions:
        - id: conditionItem_UBibnH
          condition: =Topic.PlatformsToScan = 'creb3_assessmentAgent.topic.DetermineWhatAutomationToRun.main.question_M9PVF1'.Environment
          actions:
            - kind: InvokeConnectorAction
              id: invokeConnectorAction_91CwLy
              displayName: Update to scan environment and telemetry
              input:
                binding:
                  entityName: msft_assessments
                  item: "={msft_scanenvironment: true, msft_scantelemetry: true}"
                  organization: current
                  recordId: =Global.AssessmentRecord.msft_assessmentid

              output:
                kind: SingleVariableOutputBinding
                variable: Topic.UpdateOnlyRecordWithOrganization

              connectionReference: creb3_assessmentAgent.shared_commondataserviceforapps.shared-commondataser-15032637-2412-4e4c-b4c4-b24b17c89e23
              connectionProperties:
                mode: Invoker

              dynamicInputSchema:
                properties:
                  entityName:
                    displayName: Table name
                    description: Choose a table
                    isRequired: true
                    order: 1
                    dynamicValuesConfig:
                      capability: List

                    type: String

                  item:
                    displayName: Row Item
                    description: Row to update
                    isRequired: true
                    order: 3
                    type:
                      kind: Record
                      properties:
                        msft_name:
                          displayName: Name
                          order: 0
                          type: String

                        msft_scanenvironment:
                          displayName: Scan Environment
                          visibility: Advanced
                          order: 3
                          type: Boolean

                        msft_scantelemetry:
                          displayName: Scan Telemetry
                          visibility: Advanced
                          order: 4
                          type: Boolean

                        msft_scantenant:
                          displayName: Scan Tenant
                          visibility: Advanced
                          order: 5
                          type: Boolean

                        ownerid@odata.bind:
                          displayName: Owner (Owners)
                          description: Owner Id
                          visibility: Advanced
                          order: 1
                          type: String

                        owningbusinessunit@odata.bind:
                          displayName: Owning Business Unit (Business Units)
                          description: Unique identifier for the business unit that owns the record
                          visibility: Advanced
                          order: 2
                          type: String

                        statecode:
                          displayName: Status
                          description: Status of the Assessment
                          visibility: Advanced
                          order: 6
                          dynamicValuesConfig:
                            capability: List

                          type: Number

                        statuscode:
                          displayName: Status Reason
                          description: Reason for the status of the Assessment
                          visibility: Advanced
                          order: 7
                          dynamicValuesConfig:
                            capability: List

                          type: Number

                        timezoneruleversionnumber:
                          displayName: Time Zone Rule Version Number
                          description: For internal use only.
                          visibility: Advanced
                          order: 8
                          type: Number

                        utcconversiontimezonecode:
                          displayName: UTC Conversion Time Zone Code
                          description: Time zone code that was in use when the record was created.
                          visibility: Advanced
                          order: 9
                          type: Number

                  organization:
                    displayName: Environment
                    description: Choose an environment
                    isRequired: true
                    order: 0
                    dynamicValuesConfig:
                      capability: List

                    type: String

                  recordId:
                    displayName: Row ID
                    description: Enter the row's globally unique identifier (GUID)
                    isRequired: true
                    order: 2
                    type: String

                  x-ms-odata-metadata-full:
                    displayName: Return Full Metadata
                    description: The header parameter to customer to opt-in returning full odata metadata in response.
                    visibility: Advanced
                    order: 4
                    type: Boolean

              dynamicOutputSchema:
                kind: Record
                properties:
                  _createdby_value:
                    displayName: Created By (Value)
                    description: Unique identifier of the user who created the record.
                    visibility: Advanced
                    order: 4
                    type: String

                  _createdby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Created By (Type)
                    description: Unique identifier of the user who created the record.
                    visibility: Advanced
                    order: 3
                    type: String

                  _createdonbehalfby_value:
                    displayName: Created By (Delegate) (Value)
                    description: Unique identifier of the delegate user who created the record.
                    visibility: Advanced
                    order: 2
                    type: String

                  _createdonbehalfby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Created By (Delegate) (Type)
                    description: Unique identifier of the delegate user who created the record.
                    visibility: Advanced
                    order: 1
                    type: String

                  _modifiedby_value:
                    displayName: Modified By (Value)
                    description: Unique identifier of the user who modified the record.
                    visibility: Advanced
                    order: 10
                    type: String

                  _modifiedby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Modified By (Type)
                    description: Unique identifier of the user who modified the record.
                    visibility: Advanced
                    order: 9
                    type: String

                  _modifiedonbehalfby_value:
                    displayName: Modified By (Delegate) (Value)
                    description: Unique identifier of the delegate user who modified the record.
                    visibility: Advanced
                    order: 8
                    type: String

                  _modifiedonbehalfby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Modified By (Delegate) (Type)
                    description: Unique identifier of the delegate user who modified the record.
                    visibility: Advanced
                    order: 7
                    type: String

                  _ownerid_value:
                    displayName: Owner (Value)
                    description: Owner Id
                    visibility: Advanced
                    order: 15
                    type: String

                  _ownerid_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owner (Type)
                    description: Owner Id
                    visibility: Advanced
                    order: 14
                    type: String

                  _owningbusinessunit_value:
                    displayName: Owning Business Unit (Value)
                    description: Unique identifier for the business unit that owns the record
                    visibility: Advanced
                    order: 17
                    type: String

                  _owningbusinessunit_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning Business Unit (Type)
                    description: Unique identifier for the business unit that owns the record
                    visibility: Advanced
                    order: 16
                    type: String

                  _owningteam_value:
                    displayName: Owning Team (Value)
                    description: Unique identifier for the team that owns the record.
                    visibility: Advanced
                    order: 19
                    type: String

                  _owningteam_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning Team (Type)
                    description: Unique identifier for the team that owns the record.
                    visibility: Advanced
                    order: 18
                    type: String

                  _owninguser_value:
                    displayName: Owning User (Value)
                    description: Unique identifier for the user that owns the record.
                    visibility: Advanced
                    order: 21
                    type: String

                  _owninguser_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning User (Type)
                    description: Unique identifier for the user that owns the record.
                    visibility: Advanced
                    order: 20
                    type: String

                  @odata.id:
                    displayName: OData Id
                    description: OData row id
                    order: 13
                    type: String

                  createdon:
                    displayName: Created On
                    description: Date and time when the record was created.
                    visibility: Advanced
                    order: 5
                    type: DateTime

                  importsequencenumber:
                    displayName: Import Sequence Number
                    description: Sequence number of the import that created this record.
                    visibility: Advanced
                    order: 6
                    type: Number

                  modifiedon:
                    displayName: Modified On
                    description: Date and time when the record was modified.
                    visibility: Advanced
                    order: 11
                    type: DateTime

                  msft_assessmentid:
                    displayName: Assessment
                    description: Unique identifier for entity instances
                    visibility: Advanced
                    order: 0
                    type: String

                  msft_name:
                    displayName: Name
                    order: 12
                    type: String

                  msft_scanenvironment:
                    displayName: Scan Environment
                    visibility: Advanced
                    order: 23
                    type: Boolean

                  msft_scantelemetry:
                    displayName: Scan Telemetry
                    visibility: Advanced
                    order: 24
                    type: Boolean

                  msft_scantenant:
                    displayName: Scan Tenant
                    visibility: Advanced
                    order: 25
                    type: Boolean

                  overriddencreatedon:
                    displayName: Record Created On
                    description: Date and time that the record was migrated.
                    visibility: Advanced
                    order: 22
                    type: DateTime

                  statecode:
                    displayName: Status
                    description: Status of the Assessment
                    visibility: Advanced
                    order: 26
                    dynamicValuesConfig:
                      capability: List

                    type: Number

                  statuscode:
                    displayName: Status Reason
                    description: Reason for the status of the Assessment
                    visibility: Advanced
                    order: 27
                    dynamicValuesConfig:
                      capability: List

                    type: Number

                  timezoneruleversionnumber:
                    displayName: Time Zone Rule Version Number
                    description: For internal use only.
                    visibility: Advanced
                    order: 28
                    type: Number

                  utcconversiontimezonecode:
                    displayName: UTC Conversion Time Zone Code
                    description: Time zone code that was in use when the record was created.
                    visibility: Advanced
                    order: 29
                    type: Number

                  versionnumber:
                    displayName: Version Number
                    description: Version Number
                    visibility: Advanced
                    order: 30
                    type: Number

              operationId: UpdateOnlyRecordWithOrganization

        - id: conditionItem_QehVTc
          condition: =Topic.PlatformsToScan = 'creb3_assessmentAgent.topic.DetermineWhatAutomationToRun.main.question_M9PVF1'.Tenant
          actions:
            - kind: InvokeConnectorAction
              id: invokeConnectorAction_vCPCkZ
              input:
                binding:
                  entityName: msft_assessments
                  item: "={msft_scantenant: true}"
                  organization: current
                  recordId: =Global.AssessmentRecord.msft_assessmentid

              output:
                kind: SingleVariableOutputBinding
                variable: Topic.UpdateOnlyRecordWithOrganization

              connectionReference: creb3_assessmentAgent.shared_commondataserviceforapps.shared-commondataser-15032637-2412-4e4c-b4c4-b24b17c89e23
              connectionProperties:
                mode: Invoker

              dynamicInputSchema:
                properties:
                  entityName:
                    displayName: Table name
                    description: Choose a table
                    isRequired: true
                    order: 1
                    dynamicValuesConfig:
                      capability: List

                    type: String

                  item:
                    displayName: Row Item
                    description: Row to update
                    isRequired: true
                    order: 3
                    type:
                      kind: Record
                      properties:
                        msft_name:
                          displayName: Name
                          order: 0
                          type: String

                        msft_scanenvironment:
                          displayName: Scan Environment
                          visibility: Advanced
                          order: 3
                          type: Boolean

                        msft_scantelemetry:
                          displayName: Scan Telemetry
                          visibility: Advanced
                          order: 4
                          type: Boolean

                        msft_scantenant:
                          displayName: Scan Tenant
                          visibility: Advanced
                          order: 5
                          type: Boolean

                        ownerid@odata.bind:
                          displayName: Owner (Owners)
                          description: Owner Id
                          visibility: Advanced
                          order: 1
                          type: String

                        owningbusinessunit@odata.bind:
                          displayName: Owning Business Unit (Business Units)
                          description: Unique identifier for the business unit that owns the record
                          visibility: Advanced
                          order: 2
                          type: String

                        statecode:
                          displayName: Status
                          description: Status of the Assessment
                          visibility: Advanced
                          order: 6
                          dynamicValuesConfig:
                            capability: List

                          type: Number

                        statuscode:
                          displayName: Status Reason
                          description: Reason for the status of the Assessment
                          visibility: Advanced
                          order: 7
                          dynamicValuesConfig:
                            capability: List

                          type: Number

                        timezoneruleversionnumber:
                          displayName: Time Zone Rule Version Number
                          description: For internal use only.
                          visibility: Advanced
                          order: 8
                          type: Number

                        utcconversiontimezonecode:
                          displayName: UTC Conversion Time Zone Code
                          description: Time zone code that was in use when the record was created.
                          visibility: Advanced
                          order: 9
                          type: Number

                  organization:
                    displayName: Environment
                    description: Choose an environment
                    isRequired: true
                    order: 0
                    dynamicValuesConfig:
                      capability: List

                    type: String

                  recordId:
                    displayName: Row ID
                    description: Enter the row's globally unique identifier (GUID)
                    isRequired: true
                    order: 2
                    type: String

                  x-ms-odata-metadata-full:
                    displayName: Return Full Metadata
                    description: The header parameter to customer to opt-in returning full odata metadata in response.
                    visibility: Advanced
                    order: 4
                    type: Boolean

              dynamicOutputSchema:
                kind: Record
                properties:
                  _createdby_value:
                    displayName: Created By (Value)
                    description: Unique identifier of the user who created the record.
                    visibility: Advanced
                    order: 4
                    type: String

                  _createdby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Created By (Type)
                    description: Unique identifier of the user who created the record.
                    visibility: Advanced
                    order: 3
                    type: String

                  _createdonbehalfby_value:
                    displayName: Created By (Delegate) (Value)
                    description: Unique identifier of the delegate user who created the record.
                    visibility: Advanced
                    order: 2
                    type: String

                  _createdonbehalfby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Created By (Delegate) (Type)
                    description: Unique identifier of the delegate user who created the record.
                    visibility: Advanced
                    order: 1
                    type: String

                  _modifiedby_value:
                    displayName: Modified By (Value)
                    description: Unique identifier of the user who modified the record.
                    visibility: Advanced
                    order: 10
                    type: String

                  _modifiedby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Modified By (Type)
                    description: Unique identifier of the user who modified the record.
                    visibility: Advanced
                    order: 9
                    type: String

                  _modifiedonbehalfby_value:
                    displayName: Modified By (Delegate) (Value)
                    description: Unique identifier of the delegate user who modified the record.
                    visibility: Advanced
                    order: 8
                    type: String

                  _modifiedonbehalfby_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Modified By (Delegate) (Type)
                    description: Unique identifier of the delegate user who modified the record.
                    visibility: Advanced
                    order: 7
                    type: String

                  _ownerid_value:
                    displayName: Owner (Value)
                    description: Owner Id
                    visibility: Advanced
                    order: 15
                    type: String

                  _ownerid_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owner (Type)
                    description: Owner Id
                    visibility: Advanced
                    order: 14
                    type: String

                  _owningbusinessunit_value:
                    displayName: Owning Business Unit (Value)
                    description: Unique identifier for the business unit that owns the record
                    visibility: Advanced
                    order: 17
                    type: String

                  _owningbusinessunit_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning Business Unit (Type)
                    description: Unique identifier for the business unit that owns the record
                    visibility: Advanced
                    order: 16
                    type: String

                  _owningteam_value:
                    displayName: Owning Team (Value)
                    description: Unique identifier for the team that owns the record.
                    visibility: Advanced
                    order: 19
                    type: String

                  _owningteam_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning Team (Type)
                    description: Unique identifier for the team that owns the record.
                    visibility: Advanced
                    order: 18
                    type: String

                  _owninguser_value:
                    displayName: Owning User (Value)
                    description: Unique identifier for the user that owns the record.
                    visibility: Advanced
                    order: 21
                    type: String

                  _owninguser_value@Microsoft.Dynamics.CRM.lookuplogicalname:
                    displayName: Owning User (Type)
                    description: Unique identifier for the user that owns the record.
                    visibility: Advanced
                    order: 20
                    type: String

                  @odata.id:
                    displayName: OData Id
                    description: OData row id
                    order: 13
                    type: String

                  createdon:
                    displayName: Created On
                    description: Date and time when the record was created.
                    visibility: Advanced
                    order: 5
                    type: DateTime

                  importsequencenumber:
                    displayName: Import Sequence Number
                    description: Sequence number of the import that created this record.
                    visibility: Advanced
                    order: 6
                    type: Number

                  modifiedon:
                    displayName: Modified On
                    description: Date and time when the record was modified.
                    visibility: Advanced
                    order: 11
                    type: DateTime

                  msft_assessmentid:
                    displayName: Assessment
                    description: Unique identifier for entity instances
                    visibility: Advanced
                    order: 0
                    type: String

                  msft_name:
                    displayName: Name
                    order: 12
                    type: String

                  msft_scanenvironment:
                    displayName: Scan Environment
                    visibility: Advanced
                    order: 23
                    type: Boolean

                  msft_scantelemetry:
                    displayName: Scan Telemetry
                    visibility: Advanced
                    order: 24
                    type: Boolean

                  msft_scantenant:
                    displayName: Scan Tenant
                    visibility: Advanced
                    order: 25
                    type: Boolean

                  overriddencreatedon:
                    displayName: Record Created On
                    description: Date and time that the record was migrated.
                    visibility: Advanced
                    order: 22
                    type: DateTime

                  statecode:
                    displayName: Status
                    description: Status of the Assessment
                    visibility: Advanced
                    order: 26
                    dynamicValuesConfig:
                      capability: List

                    type: Number

                  statuscode:
                    displayName: Status Reason
                    description: Reason for the status of the Assessment
                    visibility: Advanced
                    order: 27
                    dynamicValuesConfig:
                      capability: List

                    type: Number

                  timezoneruleversionnumber:
                    displayName: Time Zone Rule Version Number
                    description: For internal use only.
                    visibility: Advanced
                    order: 28
                    type: Number

                  utcconversiontimezonecode:
                    displayName: UTC Conversion Time Zone Code
                    description: Time zone code that was in use when the record was created.
                    visibility: Advanced
                    order: 29
                    type: Number

                  versionnumber:
                    displayName: Version Number
                    description: Version Number
                    visibility: Advanced
                    order: 30
                    type: Number

              operationId: UpdateOnlyRecordWithOrganization

        - id: conditionItem_eZyCsC
          condition: =Topic.PlatformsToScan = 'creb3_assessmentAgent.topic.DetermineWhatAutomationToRun.main.question_M9PVF1'.None

inputType: {}
outputType: {}